(function(e){function t(t){for(var r,o,i=t[0],c=t[1],u=t[2],d=0,h=[];d<i.length;d++)o=i[d],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&h.push(n[o][0]),n[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);l&&l(t);while(h.length)h.shift()();return a.push.apply(a,u||[]),s()}function s(){for(var e,t=0;t<a.length;t++){for(var s=a[t],r=!0,i=1;i<s.length;i++){var c=s[i];0!==n[c]&&(r=!1)}r&&(a.splice(t--,1),e=o(o.s=s[0]))}return e}var r={},n={app:0},a=[];function o(t){if(r[t])return r[t].exports;var s=r[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=e,o.c=r,o.d=function(e,t,s){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(s,r,function(t){return e[t]}.bind(null,r));return s},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var l=c;a.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"034f":function(e,t,s){"use strict";s("85ec")},"0352":function(e,t,s){},"0e69":function(e,t,s){"use strict";s("f9ba")},1503:function(e,t,s){"use strict";s("2457")},"1cbb":function(e,t,s){"use strict";s("ddaf")},"1eff":function(e,t,s){},"20d0":function(e,t,s){},"211b":function(e,t,s){"use strict";s("c040")},"211ba":function(e,t,s){"use strict";s("6ca3")},2457:function(e,t,s){},"252d":function(e,t,s){},2657:function(e,t,s){"use strict";s("cec4")},"26db":function(e,t,s){"use strict";s("4a06")},"27c7":function(e,t,s){"use strict";s("b7b0")},"2b18":function(e,t,s){"use strict";s("20d0")},"308b":function(e,t,s){},"39fc":function(e,t,s){},"3b70":function(e,t,s){},"4a06":function(e,t,s){},"557a":function(e,t,s){},"56d7":function(e,t,s){"use strict";s.r(t);s("e260"),s("e6cf"),s("cca6"),s("a79d");var r=s("2b0e"),n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("Header"),s("router-view"),s("Footer")],1)},a=[],o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"modals"},[s("SignInModal",{model:{value:e.signInModalOpen,callback:function(t){e.signInModalOpen=t},expression:"signInModalOpen"}}),s("RegisterModal",{model:{value:e.registerModalOpen,callback:function(t){e.registerModalOpen=t},expression:"registerModalOpen"}})],1),s("div",{staticClass:"header-component"},[s("div",{staticClass:"overlay"},[s("h1",{staticClass:"title",on:{click:e.backToHomePage}},[e._v("Superhero Forum")]),s("div",{staticClass:"menu-options"},[s("div",{staticClass:"message-items"},[s("div",{staticClass:"message-new-item"},[e.newMessages&&e.isLoggedIn?s("h4",{staticClass:"new-messages"},[e._v("New")]):e._e()]),e.currentUser?s("h3",{staticClass:"messages",on:{click:e.goToConversations}},[e._v("Messages")]):e._e()]),s("h3",{on:{click:e.goToProfile}},[e._v(e._s(e.currentUser.username))]),s("div",{staticClass:"sign-in",attrs:{id:"sign-in-options"}},[s("h3",{on:{click:e.showSignInModal}},[e._v("Login /")]),s("h3",{on:{click:e.showRegisterModal}},[e._v("Register")])]),s("div",{attrs:{id:"logout-option"}},[s("h3",{on:{click:e.signOutUser}},[e._v("Logout")])])])])]),s("div",{staticClass:"line"})])},i=[],c=(s("d3b7"),s("96cf"),s("1da1")),u=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"show",rawName:"v-show",value:e.value,expression:"value"}],staticClass:"modal"},[s("div",{staticClass:"background",on:{click:e.close}}),s("div",{staticClass:"form"},[s("h2",{staticClass:"title"},[e._v("Sign In")]),s("form",[e._m(0),s("p",{directives:[{name:"show",rawName:"v-show",value:e.failed,expression:"failed"}],staticClass:"warning"},[e._v("Wrong email or password!")])]),s("div",{staticClass:"buttons"},[s("input",{attrs:{type:"submit",value:"Login"},on:{click:e.login}}),s("button",{on:{click:function(t){return t.preventDefault(),e.close(t)}}},[e._v("Close")])])])])},l=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"input-fields"},[s("input",{attrs:{required:"",type:"email",id:"email",name:"email",placeholder:"email"}}),s("br"),s("input",{attrs:{required:"",type:"password",id:"password",name:"password",placeholder:"password"}}),s("br")])}],d={name:"SignIn-Modal",props:{value:{required:!0}},data:function(){return{failed:!1}},methods:{close:function(){this.clearFields(),this.failed=!1,this.$emit("input",!this.value)},login:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function s(){var r;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return e.preventDefault(),s.next=3,t.$store.dispatch("signInUser",{email:document.getElementById("email").value,password:document.getElementById("password").value});case 3:r=s.sent,r?t.close():(console.log("Login attempt failed!"),t.failed=!0);case 5:case"end":return s.stop()}}),s)})))()},clearFields:function(){document.getElementById("email").value="",document.getElementById("password").value=""},hello:function(){console.log("HELLO")}}},h=d,f=(s("7467"),s("2877")),m=Object(f["a"])(h,u,l,!1,null,"09f1f9ff",null),p=m.exports,v=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"show",rawName:"v-show",value:e.value,expression:"value"}],staticClass:"modal"},[s("div",{staticClass:"background",on:{click:e.close}}),s("div",{staticClass:"form"},[e._m(0),s("div",[s("form",[e._m(1),s("p",{directives:[{name:"show",rawName:"v-show",value:e.failed,expression:"failed"}]},[e._v("Registration failed!")]),s("div",{staticClass:"buttons"},[s("button",{staticClass:"register",attrs:{type:"submit",value:"Register"},on:{click:e.register}},[e._v("Register")]),s("h4",{staticClass:"cancel",on:{click:function(t){return t.preventDefault(),e.close(t)}}},[e._v("Cancel")])])])])])])},g=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"title"},[s("h2",[e._v("Create Account")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"input-fields"},[s("input",{attrs:{type:"email",id:"reg-email",name:"reg-email",placeholder:"email",required:""}}),s("br"),s("input",{attrs:{type:"text",id:"reg-username",name:"reg-username",placeholder:"username",required:""}}),s("br"),s("input",{attrs:{type:"password",id:"reg-password",name:"reg-password",minlength:"8",placeholder:"password",required:""}}),s("br")])}],b={name:"Register-Modal",props:{value:{required:!0}},data:function(){return{failed:!1}},methods:{close:function(){this.clearFields(),this.failed=!1,this.$emit("input",!this.value)},register:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function s(){var r;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return e.preventDefault(),s.next=3,t.$store.dispatch("registerUser",{email:document.getElementById("reg-email").value,password:document.getElementById("reg-password").value,username:document.getElementById("reg-username").value});case 3:r=s.sent,r.error&&(t.failed=!0),r&&t.close();case 6:case"end":return s.stop()}}),s)})))()},clearFields:function(){document.getElementById("reg-email").value="",document.getElementById("reg-password").value="",document.getElementById("reg-username").value=""}}},w=b,_=(s("f7af"),Object(f["a"])(w,v,g,!1,null,"20af3947",null)),C=_.exports,x={components:{SignInModal:p,RegisterModal:C},data:function(){return{signInModalOpen:!1,registerModalOpen:!1,newMessages:!1}},computed:{currentUser:function(){return this.$store.getters.currentUser||""},isLoggedIn:function(){return null!==this.$store.getters.currentUser}},methods:{backToHomePage:function(){"/"!==this.$route.path&&this.$router.push("/")},hideElements:function(e){var t=document.getElementById("sign-in-options"),s=document.getElementById("logout-option");e?(t.style.display="none",s.style.display="block"):(t.style.display="block",s.style.display="none")},showSignInModal:function(){this.signInModalOpen=!this.signInModalOpen},showRegisterModal:function(){this.registerModalOpen=!this.registerModalOpen},goToProfile:function(){"/"!==this.$route.path&&this.$router.push("/"),this.$router.push({name:"ProfilePage",params:{user:this.currentUser}})},goToConversations:function(){this.$router.push({name:"ConversationsPage",params:{user:this.currentUser}})},signOutUser:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest/v1/logout",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:e.currentUser})});case 2:return s=t.sent,t.next=5,s.json();case 5:s=t.sent,s&&(e.hideElements(!1),e.$store.commit("setCurrentUser",null),"/"!==e.$route.path&&e.$router.push("/"));case 7:case"end":return t.stop()}}),t)})))()},getNewMessagesCount:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.currentUser){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,fetch("/rest/v1/messages/all/".concat(e.currentUser.id));case 4:return s=t.sent,t.next=7,s.json();case 7:s=t.sent,s[0]["COUNT(unread)"]>0&&(e.newMessages=!0);case 9:case"end":return t.stop()}}),t)})))()}},mounted:function(){this.hideElements(!1),this.getNewMessagesCount()},watch:{currentUser:function(){null===this.$store.getters.currentUser?this.hideElements(!1):this.hideElements(!0),null!==this.$store.getters.currentUser&&this.getNewMessagesCount()}}},O=x,y=(s("69d3"),Object(f["a"])(O,o,i,!1,null,"bdd49f00",null)),I=y.exports,k=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},j=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"footer"},[s("h4",[e._v("@Batman")])])}],R={data:function(){return{some:1}}},P=R,E=(s("9386"),Object(f["a"])(P,k,j,!1,null,"28980c62",null)),T=E.exports,$={name:"app",components:{Header:I,Footer:T},created:function(){this.$store.dispatch("fetchCurrentUser")}},U=$,M=(s("034f"),Object(f["a"])(U,n,a,!1,null,null,null)),S=M.exports,D=s("8c4f"),q=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"home-page"},[s("subforum-list")],1)},A=[],N=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"subforum-list"},[e._m(0),e._l(e.subforums,(function(e){return s("SubforumListItem",{key:e.id,attrs:{subforum:e}})}))],2)},L=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"info"},[s("h1",[e._v("Forums")])])}],B=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"subforum-container",on:{click:e.goToSubforum}},[e._m(0),s("div",{staticClass:"info"},[s("div",{staticClass:"title-container"},[s("h3",{staticClass:"subforum-name text"},[e._v(e._s(e.subforum.title))]),s("p",{staticClass:"text"},[e._v(e._s(e.subforum.description))])]),s("div",{staticClass:"threads"},[s("p",{staticClass:"threads-title"},[e._v("Threads")]),s("p",{staticClass:"amount"},[e._v(e._s(this.threadsAmount))])])])])},J=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"icon-img"},[s("span",{staticClass:"material-icons",staticStyle:{"font-size":"5em"}},[e._v("chat")])])}],F={props:["subforum"],data:function(){return{threadsAmount:0}},methods:{goToSubforum:function(){this.$router.push({name:"SubforumPage",params:{subforum:this.subforum}})},fetchThreadCount:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest/v1/threads/count/".concat(e.subforum.id));case 2:return s=t.sent,t.next=5,s.json();case 5:s=t.sent,e.threadsAmount=s[0]["COUNT(subforumId)"];case 7:case"end":return t.stop()}}),t)})))()}},created:function(){this.fetchThreadCount()}},Q=F,H=(s("ab60"),Object(f["a"])(Q,B,J,!1,null,"f0d02c86",null)),W=H.exports,z={components:{SubforumListItem:W},data:function(){return{subforums:[]}},methods:{fetchSubforums:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest/v1/subforums");case 2:return s=t.sent,t.next=5,s.json();case 5:e.subforums=t.sent;case 6:case"end":return t.stop()}}),t)})))()}},created:function(){this.fetchSubforums()}},X=z,Y=(s("a7a0"),Object(f["a"])(X,N,L,!1,null,"563c0638",null)),G=Y.exports,V={components:{SubforumList:G}},K=V,Z=(s("0e69"),Object(f["a"])(K,q,A,!1,null,"60a6d85d",null)),ee=Z.exports,te=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"subforum-page"},[s("div",{staticClass:"top"},[s("div",{staticClass:"info"},[s("h1",{staticClass:"title"},[e._v(e._s(this.$route.params.subforum.title))]),s("h2",[e._v(e._s(this.$route.params.subforum.description))])]),s("div",{staticClass:"create"},[s("h3",{on:{click:e.createNewThread}},[e._v("Create Thread")])])]),s("hr",{staticStyle:{border:"black",color:"black",width:"60%",height:"2px","background-color":"black"}}),s("ThreadList",{staticClass:"thread-list",attrs:{subforum:this.$route.params.subforum}})],1)},se=[],re=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"thread-list"},e._l(e.threads,(function(e,t){return s("ThreadListItem",{key:e.id,attrs:{thread:e,index:t}})})),1)},ne=[],ae=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"thread-container",class:{evenRow:!e.isEvenRow},on:{click:e.goToThreadPage}},[s("div",{staticClass:"container"},[s("div",{staticClass:"left"},[e._m(0),s("div",{staticClass:"user-info"},[s("div",{staticClass:"title-close"},[s("div",{staticClass:"thread-title"},[s("h2",{staticClass:"title"},[e._v(e._s(e.thread.title))])])]),s("div",{staticClass:"thread-info"},[s("h4",[s("span",{staticClass:"author",on:{click:e.goToProfile}},[e._v(e._s(e.author.username)+" - "+e._s(e.publishedDate))])])])])]),s("div",{staticClass:"closed"},[e.isClosed?s("h2",[e._v("closed")]):e._e(),s("div",{staticClass:"amount"},[s("p",[e._v("Posts")]),s("p",[e._v(e._s(e.postsAmount))])])])])])},oe=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"user-icon"},[s("span",{staticClass:"material-icons",staticStyle:{"font-size":"3.4em"}},[e._v("folder")])])}],ie={props:["thread","index"],data:function(){return{author:Object,postsAmount:0}},computed:{publishedDate:function(){var e=["Jan","Feb","Mar","Apr","May","June","July","Aug","Sept","Oct","Nov","Dec"],t=new Date(this.thread.published_time);return e[t.getMonth()]+"  "+t.getDay()+", "+t.getFullYear()},isEvenRow:function(){return this.index%2==0},isClosed:function(){return 0==this.thread.active}},methods:{goToThreadPage:function(){this.$router.push({name:"ThreadPage",params:{thread:this.thread}})},goToProfile:function(){this.$router.push({name:"ProfilePage",params:{user:this.author}})},fetchAuthor:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest/v1/users/".concat(e.thread.userId));case 2:return s=t.sent,t.next=5,s.json();case 5:e.author=t.sent;case 6:case"end":return t.stop()}}),t)})))()},fetchPostAmount:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest/v1/posts/count/".concat(e.thread.id));case 2:return s=t.sent,t.next=5,s.json();case 5:s=t.sent,e.postsAmount=s[0]["COUNT(threadId)"];case 7:case"end":return t.stop()}}),t)})))()}},created:function(){this.fetchAuthor(),this.fetchPostAmount()}},ce=ie,ue=(s("75a5"),Object(f["a"])(ce,ae,oe,!1,null,"3883da5c",null)),le=ue.exports,de={props:["subforum"],components:{ThreadListItem:le},data:function(){return{threads:[]}},methods:{fetchAllThreads:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest/v1/threads/".concat(e.subforum.id));case 2:return s=t.sent,t.next=5,s.json();case 5:e.threads=t.sent;case 6:case"end":return t.stop()}}),t)})))()}},created:function(){this.fetchAllThreads()}},he=de,fe=(s("962f"),Object(f["a"])(he,re,ne,!1,null,"5373e087",null)),me=fe.exports,pe={components:{ThreadList:me},methods:{createNewThread:function(){this.$router.push({name:"threadCreation",params:{subforum:this.$route.params.subforum}})}}},ve=pe,ge=(s("211b"),Object(f["a"])(ve,te,se,!1,null,"403d27b6",null)),be=ge.exports,we=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"thread-page",attrs:{id:"thread-page"}},[s("NewPostModal",{attrs:{threadId:this.thread.id},on:{reload:e.fetchPosts,myEvent:e.modalClosed},model:{value:e.newpostModalOpen,callback:function(t){e.newpostModalOpen=t},expression:"newpostModalOpen"}}),s("div",{staticClass:"page-head"},[s("h1",{staticClass:"title",class:{showclose:e.showCloseThread}},[e._v(e._s(e.thread.title))]),e.showCloseThread?s("div",{staticClass:"admin-options"},[s("div",{staticClass:"opt-close tab"},[s("h2",{on:{click:e.closeThread}},[e._v("Close Thread")])]),s("div",{staticClass:"opt-remove tab"},[s("h2",{on:{click:e.removeThread}},[e._v("Remove Thread")])])]):e._e()]),e.threadClosed?s("div",{staticClass:"closed"},[s("h3",{staticClass:"closed-text"},[e._v("Thread Closed!")])]):e._e(),s("PostList",{staticClass:"list",attrs:{posts:this.posts,thread:this.thread}}),s("div",{staticClass:"buttons"},[e.threadClosed?e._e():s("div",{staticClass:"post",on:{click:e.newPost}},[s("h2",[e._v("New Post")])])]),e.shouldPost?s("div",{staticClass:"newpost",attrs:{id:"newpost"}},[s("NewPost",{attrs:{quote:e.quotedPost,threadId:this.thread.id}})],1):e._e()],1)},_e=[],Ce=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"post-list"},e._l(e.posts,(function(t){return s("PostListItem",{key:t.id,attrs:{post:t,thread:e.thread}})})),1)},xe=[],Oe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"post-container",class:{warning:e.isWarning}},[s("div",{staticClass:"profile",on:{click:e.goToProfile}},[s("h3",{staticClass:"author"},[e._v(e._s(e.author.username))]),s("img",{staticClass:"image",attrs:{src:e.author.imgUrl}}),s("h4",[e._v(e._s(e.author.userRole))])]),s("div",{staticClass:"main"},[s("div",{staticClass:"top"},[s("div",{staticClass:"published"},[s("h3",[e._v(e._s(e.publishedDate))])]),s("div",[e.isWarning?s("h2",[e._v("Warning!")]):e._e()]),s("div",{staticClass:"options"},[e.isLoggedIn?s("div",{staticClass:"quote",on:{click:e.quoteUser}},[s("h2",[e._v("quote")])]):e._e(),e.isEditable?s("div",{staticClass:"edit",on:{click:e.edit}},[s("h3",[e._v("Edit")])]):e._e(),s("div",{staticClass:"remove"},[e.isAuthorized?s("div",{on:{click:e.remove}},[s("h3",[e._v("remove")])]):e._e()])])]),s("div",{staticClass:"message"},[this.quote?s("div",[s("QuoteItem",{attrs:{quote:e.quote}})],1):e._e(),e.shouldEdit?s("div",[s("EditPost",{attrs:{post:e.post}})],1):e._e(),e.shouldEdit?e._e():s("div",[e.isEdited?s("p",{staticClass:"has-edited"},[e._v("(Edited)")]):e._e(),s("h2",{staticClass:"main-text"},[e._v(e._s(e.post.message))])])])])])},ye=[],Ie=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("textarea",{staticClass:"textarea",attrs:{id:"edit-message",type:"text",name:"edit-message",placeholder:"Enter new message...",cols:"40",rows:"5",required:""}}),s("div",[s("button",{on:{click:e.updateMessage}},[e._v("Update")]),s("button",{on:{click:e.cancel}},[e._v("Cancel")])])])},ke=[],je={props:["post"],methods:{updateMessage:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest/v1/posts/".concat(e.post.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.post.id,message:document.getElementById("edit-message").value,userId:e.post.userId,isEdited:1})});case 2:e.$parent.fetchPostsInParent(),e.cancel();case 4:case"end":return t.stop()}}),t)})))()},cancel:function(){document.getElementById("edit-message").value="",this.$parent.shouldEdit=!1}}},Re=je,Pe=Object(f["a"])(Re,Ie,ke,!1,null,"fd893470",null),Ee=Pe.exports,Te=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"quote-container"},[s("h4",{staticClass:"quote-header"},[e._v(e._s(e.publishedDate)+" - "+e._s(this.quotedAuthor.username)+" wrote:")]),s("div",[s("h3",[e._v(e._s(this.quote.message))]),1===this.quote.isEdited?s("h4",[e._v("(edited)")]):e._e()])])},$e=[],Ue={props:["quote"],data:function(){return{quotedAuthor:Object}},computed:{publishedDate:function(){var e=new Date(this.quote.published_time),t=["Jan","Feb","Mar","Apr","May","June","July","Aug","Sept","Oct","Nov","Dec"];return e.getDay()+" "+t[e.getMonth()]+", "+e.getFullYear()+" at "+e.getHours()+":"+e.getMinutes()}},methods:{fetchQuoteAuthor:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest/v1/users/".concat(e.quote.userId));case 2:return s=t.sent,t.next=5,s.json();case 5:e.quotedAuthor=t.sent;case 6:case"end":return t.stop()}}),t)})))()}},created:function(){this.fetchQuoteAuthor()}},Me=Ue,Se=(s("90b2"),Object(f["a"])(Me,Te,$e,!1,null,"096a355a",null)),De=Se.exports,qe={components:{EditPost:Ee,QuoteItem:De},props:["post","thread"],data:function(){return{author:Object,shouldEdit:!1,quote:null}},computed:{isWarning:function(){return 1===this.post.warning},isAuthorized:function(){var e=this.$store.getters.currentUser;return!!e&&("admin"===e.userRole||"moderator"===e.userRole)},isLoggedIn:function(){return null!==this.$store.getters.currentUser},isEditable:function(){return 1===this.thread.active&&(this.isAuthorized||null!==this.$store.getters.currentUser&&this.$store.getters.currentUser.id===this.author.id)},isEdited:function(){return 1===this.post.isEdited},publishedDate:function(){var e=new Date(this.post.published_time),t=new Date;if(e.getDate()<t.getDate()-7){var s=["Jan","Feb","Mar","Apr","May","June","July","Aug","Sept","Oct","Nov","Dec"];return s[e.getMonth()]+"  "+e.getDay()+", "+e.getFullYear()}var r=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],n=e.getDate()===t.getDate()?"Today":e.getDate()===t.getDate()-1?"Yesterday":r[e.getDay()];return n+" at "+e.getHours()+":"+e.getMinutes()}},methods:{fetchAuthor:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest/v1/users/".concat(e.post.userId));case 2:return s=t.sent,t.next=5,s.json();case 5:e.author=t.sent;case 6:case"end":return t.stop()}}),t)})))()},remove:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest/v1/posts/".concat(e.post.id),{method:"delete"});case 2:return s=t.sent,t.next=5,s.json();case 5:s=t.sent,console.log(s),e.fetchPostsInParent();case 8:case"end":return t.stop()}}),t)})))()},edit:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.shouldEdit=!e.shouldEdit;case 1:case"end":return t.stop()}}),t)})))()},getPossibleQuote:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest/v1/quotes/".concat(e.post.id));case 2:return s=t.sent,t.next=5,s.json();case 5:s=t.sent,s[0]&&(e.quote=s[0]);case 7:case"end":return t.stop()}}),t)})))()},fetchPostsInParent:function(){this.$parent.reload()},goToProfile:function(){this.$router.push({name:"ProfilePage",params:{user:this.author}})},quoteUser:function(){null!==this.$store.getters.currentUser?this.$parent.passQuotedPost(this.post):alert("Login to quote a message!")}},created:function(){this.fetchAuthor(),this.getPossibleQuote()}},Ae=qe,Ne=(s("1cbb"),Object(f["a"])(Ae,Oe,ye,!1,null,"58863058",null)),Le=Ne.exports,Be={components:{PostListItem:Le},props:["posts","thread"],methods:{reload:function(){this.$parent.fetchPosts()},passQuotedPost:function(e){this.$parent.setQuotedPost(e)}}},Je=Be,Fe=(s("26db"),Object(f["a"])(Je,Ce,xe,!1,null,"ddfebe14",null)),Qe=Fe.exports,He=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"show",rawName:"v-show",value:e.value,expression:"value"}],staticClass:"modal"},[s("div",{staticClass:"form"},[s("h2",{staticClass:"title"},[e._v("New Post")]),s("form",[e._m(0),e.showCheckbox?s("div",[s("label",{attrs:{for:"warning"}},[e._v("Warning message")]),s("br"),s("input",{attrs:{type:"checkbox",id:"warning",name:"warning"}})]):e._e(),s("input",{attrs:{type:"submit",value:"Post"},on:{click:e.submit}}),s("button",{on:{click:function(t){return t.preventDefault(),e.close(t)}}},[e._v("Close")])])])])},We=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"input-fields"},[s("input",{attrs:{required:"",type:"text",id:"message",name:"message",placeholder:"Enter message"}}),s("br")])}],ze=(s("a9e3"),{name:"newpost-Modal",props:{value:{required:!0},threadId:{type:Number}},computed:{showCheckbox:function(){var e=this.$store.getters.currentUser;return!!e&&("admin"===e.userRole||"moderator"===e.userRole)}},methods:{close:function(){document.getElementById("message").value="",this.$emit("myEvent","input",!this.value)},submit:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function s(){var r,n;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return e.preventDefault(),r={message:document.getElementById("message").value,userId:t.$store.getters.currentUser.id,threadId:t.threadId,published_time:Date.now(),warning:0},t.showCheckbox&&!0===document.getElementById("warning").checked&&(r.warning=1),s.next=5,fetch("/rest/v1/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 5:return n=s.sent,s.next=8,n.json();case 8:n=s.sent,console.log(n),t.close();case 11:case"end":return s.stop()}}),s)})))()}}}),Xe=ze,Ye=(s("9f17"),Object(f["a"])(Xe,He,We,!1,null,"7efe559e",null)),Ge=Ye.exports,Ve=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"post-container"},[s("form",{staticClass:"post-form"},[null!==this.quotedPost?s("div",{staticClass:"remove-quote"},[s("h4",{on:{click:function(t){return t.preventDefault(),e.removeQuote(t)}}},[e._v("remove")])]):e._e(),null!==this.quotedPost?s("div",{staticClass:"quoted-text"},[s("div",{staticClass:"quote-head"},[s("h3",[e._v("at dd-mm-yy at hh:mm "+e._s(this.quotedAuthor.username)+" wrote:")])]),s("div",[s("textarea",{directives:[{name:"model",rawName:"v-model",value:this.quotedPost.message,expression:"this.quotedPost.message"}],staticClass:"quote-textarea",attrs:{id:"quote-message",type:"text",cols:"40",rows:"5"},domProps:{value:this.quotedPost.message},on:{input:function(t){t.target.composing||e.$set(this.quotedPost,"message",t.target.value)}}})])]):e._e(),e._m(0),e.showCheckbox?s("div",{staticClass:"checkbox"},[e._m(1)]):e._e(),s("div",{staticClass:"buttons"},[s("input",{staticClass:"send",attrs:{type:"submit",value:"Post"},on:{click:function(t){return t.preventDefault(),e.createPost(t)}}}),s("button",{staticClass:"cancel",on:{click:function(t){return t.preventDefault(),e.close(t)}}},[e._v("Close")])])])])},Ke=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"input-fields"},[s("textarea",{staticClass:"textarea",attrs:{id:"post-message",type:"text",name:"post-message",placeholder:"Enter message...",cols:"40",rows:"5",required:""}}),s("br")])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("label",{staticClass:"box"},[e._v(" Warning message: "),s("input",{staticClass:"box",attrs:{type:"checkbox",id:"post-warning",name:"post-warning"}})])}],Ze={props:["quote","threadId"],data:function(){return{quotedAuthor:Object,quotedPost:null}},computed:{showCheckbox:function(){var e=this.$store.getters.currentUser;return!!e&&("admin"===e.userRole||"moderator"===e.userRole)}},methods:{close:function(){this.$parent.shouldPost=!1},removeQuote:function(){console.log("remove quote"),this.quotedPost=null},postQuotedText:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function s(){var r,n,a,o;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return console.log("post quote"),r=document.getElementById("quote-message").value,n=r!==t.quotedPost.message?1:0,a={message:r,userId:t.quotedAuthor.id,postId:e,published_time:t.quotedPost.published_time,isEdited:n},console.log(a),s.next=7,fetch("/rest/v1/quotes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});case 7:return o=s.sent,s.next=10,o.json();case 10:o=s.sent,console.log(o);case 12:case"end":return s.stop()}}),s)})))()},getQuotedAuthor:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest/v1/users/".concat(e.quote.userId));case 2:return s=t.sent,t.next=5,s.json();case 5:e.quotedAuthor=t.sent;case 6:case"end":return t.stop()}}),t)})))()},createPost:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function s(){var r,n;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(e.preventDefault(),""!==document.getElementById("post-message").value){s.next=3;break}return s.abrupt("return");case 3:return r={message:document.getElementById("post-message").value,userId:t.$store.getters.currentUser.id,threadId:t.threadId,published_time:Date.now(),warning:0},t.showCheckbox&&!0===document.getElementById("post-warning").checked&&(r.warning=1),s.next=7,fetch("/rest/v1/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 7:return n=s.sent,s.next=10,n.json();case 10:n=s.sent,console.log(n),null!==t.quotedPost&&t.postQuotedText(n.lastInsertRowid),t.$parent.fetchPosts(),t.close();case 15:case"end":return s.stop()}}),s)})))()}},created:function(){console.log("START:",this.quotedPost),this.quote&&(this.quotedPost=this.quote,this.getQuotedAuthor())}},et=Ze,tt=(s("2657"),Object(f["a"])(et,Ve,Ke,!1,null,"5a56a01e",null)),st=tt.exports,rt={components:{PostList:Qe,NewPostModal:Ge,NewPost:st},props:["thread"],data:function(){return{posts:[],threadClosed:!1,newpostModalOpen:!1,shouldPost:!1,quotedPost:null}},computed:{showCloseThread:function(){var e=this.$store.getters.currentUser;return!!e&&(("moderator"===e.userRole||"admin"===e.userRole)&&!1===this.threadClosed)},isLoggedIn:function(){return null!==this.$store.getters.currentUser}},methods:{modalClosed:function(){this.newpostModalOpen=!1,this.fetchPosts()},fetchPosts:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest/v1/posts/".concat(e.thread.id));case 2:return s=t.sent,t.next=5,s.json();case 5:s=t.sent,e.posts=s;case 7:case"end":return t.stop()}}),t)})))()},closeThread:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest/v1/threads/".concat(e.thread.id),{method:"PUT"});case 2:e.threadClosed=!0;case 3:case"end":return t.stop()}}),t)})))()},removeThread:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest/v1/threads/".concat(e.thread.id),{method:"DELETE"});case 2:e.$router.push("/");case 3:case"end":return t.stop()}}),t)})))()},setQuotedPost:function(e){!1===this.threadClosed&&(this.quotedPost=e,this.shouldPost=!0)},newPost:function(){this.isLoggedIn?this.shouldPost=!this.shouldPost:alert("Login to post a message!")},scrollToEnd:function(){}},created:function(){this.fetchPosts(),this.threadClosed=0===this.thread.active},mounted:function(){this.fetchPosts()},watch:{posts:function(){0===this.posts.length&&this.removeThread()}}},nt=rt,at=(s("c0d9"),Object(f["a"])(nt,we,_e,!1,null,"5317620e",null)),ot=at.exports,it=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"thread-creation"},[e._m(0),s("form",{staticClass:"form"},[s("label",{attrs:{for:"title"}},[e._v("Title")]),s("br"),s("input",{attrs:{required:"",id:"title",type:"text"}}),s("br"),s("label",{attrs:{for:"message"}},[e._v("Message")]),s("br"),s("textarea",{attrs:{required:"",id:"message",type:"text",name:"Text1",cols:"40",rows:"5"}}),s("div",{staticClass:"buttons"},[s("button",{staticClass:"cancel",on:{click:e.goBack}},[e._v("Cancel")]),s("button",{staticClass:"confirm",on:{click:e.createThread}},[e._v("Confirm")])])])])},ct=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"head"},[s("h1",{staticClass:"title"},[e._v("Thread Creation")])])}],ut={props:["subforum"],methods:{createThread:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function s(){var r,n;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(e.preventDefault(),""!==document.getElementById("title").value&&""!==document.getElementById("message")){s.next=3;break}return s.abrupt("return");case 3:if(r={title:document.getElementById("title").value,userId:t.$store.getters.currentUser.id,published_time:Date.now(),subforumId:t.$route.params.subforum.id},console.log("POSTING THREAD",r),null!==r.userId&&void 0!==r.userId){s.next=7;break}return s.abrupt("return");case 7:return s.next=9,fetch("/rest/v1/threads",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 9:return n=s.sent,s.next=12,n.json();case 12:n=s.sent,t.postInitialPost(r,n),r.id=n.lastInsertRowid,t.$router.push({name:"ThreadPage",params:{thread:r}});case 16:case"end":return s.stop()}}),s)})))()},postInitialPost:function(e,t){var s=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r={message:document.getElementById("message").value,userId:s.$store.getters.currentUser.id,threadId:t.lastInsertRowid,published_time:Date.now(),warning:0},console.log("POST:",r),e.next=4,fetch("/rest/v1/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 4:return n=e.sent,e.next=7,n.json();case 7:n=e.sent,console.log(n);case 9:case"end":return e.stop()}}),e)})))()},goBack:function(){this.$router.push({name:"SubforumPage",params:{subforum:this.subforum}})}}},lt=ut,dt=(s("e0fe"),Object(f["a"])(lt,it,ct,!1,null,"2330025d",null)),ht=dt.exports,ft=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"profile-page"},[s("License",{attrs:{user:e.user}}),s("div",[!e.ownProfile&&e.isLoggedIn?s("h2",{staticClass:"message",on:{click:e.goToMessagePage}},[e._v("Send PM")]):e._e()]),e.showOptions?s("div",[s("div",[s("div",{staticClass:"delete"},[s("h3",{on:{click:e.deleteUser}},[e._v("DELETE USER")])])]),s("div",{staticClass:"mode"},[e.isModerator?e._e():s("h3",{on:{click:e.makeModerator}},[e._v("Make Moderator")]),e.isModerator?s("h3",{on:{click:e.removeModerator}},[e._v("Remove Moderator")]):e._e()])]):e._e(),e.isAdminProfile?s("div",{staticClass:"list"},[s("h2",{staticClass:"list-item"},[e._v("List of users")]),s("UserList")],1):e._e()],1)},mt=[],pt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"user-list"},e._l(e.users,(function(e,t){return s("UserListItem",{key:e.id,attrs:{user:e,index:t}})})),1)},vt=[],gt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"container",on:{click:e.goToUserProfile}},[s("h2",[e._v(e._s(e.user.username))])])])},bt=[],wt={props:["user","index"],methods:{goToUserProfile:function(){console.log("GO TO PROFILE"),this.$router.push("/"),this.$router.push({name:"ProfilePage",params:{user:this.user}})}}},_t=wt,Ct=(s("d0b5"),Object(f["a"])(_t,gt,bt,!1,null,"159b7bd2",null)),xt=Ct.exports,Ot={components:{UserListItem:xt},data:function(){return{users:[]}},methods:{fetchAllUsers:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest/v1/users/");case 2:return s=t.sent,t.next=5,s.json();case 5:e.users=t.sent;case 6:case"end":return t.stop()}}),t)})))()}},created:function(){this.fetchAllUsers()}},yt=Ot,It=(s("1503"),Object(f["a"])(yt,pt,vt,!1,null,"656adb20",null)),kt=It.exports,jt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"license"},[s("div",{staticClass:"image"},[s("img",{attrs:{src:e.user.imgUrl}}),e.ownProfile?s("div",[s("p",{staticClass:"add",on:{click:function(t){e.showUrl=!e.showUrl}}},[e._v("+ add image")]),e.showUrl?s("div",{staticClass:"url-container"},[s("input",{attrs:{id:"image-url",placeholder:"image url..",type:"text"}}),s("button",{on:{click:e.addProfileImage}},[e._v("Update")])]):e._e()]):e._e()]),s("div",{staticClass:"info"},[s("div",{staticClass:"head"},[s("h2",{staticClass:"username"},[e._v(e._s(e.user.username))])]),s("h3",{staticClass:"email"},[e._v("email: "+e._s(e.user.email))]),s("h3",{staticClass:"role"},[e._v("role: "+e._s(e.user.userRole))])])])},Rt=[],Pt={props:["user"],data:function(){return{showUrl:!1}},computed:{ownProfile:function(){return null!==this.$store.getters.currentUser&&this.$store.getters.currentUser.id===this.user.id}},methods:{addProfileImage:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(s=document.getElementById("image-url").value,""!==s){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,fetch("/rest/v1/users/".concat(e.$store.getters.currentUser.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({imgUrl:s})});case 5:r=t.sent,e.user.imgUrl=s,s="",console.log(r);case 9:case"end":return t.stop()}}),t)})))()}}},Et=Pt,Tt=(s("27c7"),Object(f["a"])(Et,jt,Rt,!1,null,"509f89bc",null)),$t=Tt.exports,Ut={components:{UserList:kt,License:$t},props:["user"],computed:{ownProfile:function(){return null!==this.$store.getters.currentUser&&this.$store.getters.currentUser.id===this.user.id},isLoggedIn:function(){return null!==this.$store.getters.currentUser},showOptions:function(){return"admin"!==this.user.userRole&&(null!==this.$store.getters.currentUser&&"admin"===this.$store.getters.currentUser.userRole)},isModerator:function(){return null!==this.user.userRole&&"moderator"===this.user.userRole},isAdminProfile:function(){return null!==this.user.userRole&&"admin"===this.user.userRole&&null!==this.$store.getters.currentUser&&"admin"===this.$store.getters.currentUser.userRole}},methods:{deleteUser:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest/v1/users/".concat(e.user.id),{method:"DELETE"});case 2:return s=t.sent,t.next=5,s.json();case 5:s=t.sent,console.log(s),e.goToHomePage();case 8:case"end":return t.stop()}}),t)})))()},goToHomePage:function(){this.$router.push("/")},goToMessagePage:function(){this.$router.push({name:"MessagePage",params:{user:this.user}})},makeModerator:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("Admin"!==e.user.userRole){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,fetch("/rest/v1/users/".concat(e.user.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({userRole:"moderator"})});case 4:return s=t.sent,t.next=7,s.json();case 7:s=t.sent,console.log(s),s&&(e.user.userRole="moderator");case 10:case"end":return t.stop()}}),t)})))()},removeModerator:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest/v1/users/".concat(e.user.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({userRole:"member"})});case 2:return s=t.sent,t.next=5,s.json();case 5:s=t.sent,console.log(s),s&&(e.user.userRole="member");case 8:case"end":return t.stop()}}),t)})))()}}},Mt=Ut,St=(s("d454"),Object(f["a"])(Mt,ft,mt,!1,null,"2cf4a788",null)),Dt=St.exports,qt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page"},[s("div",{staticClass:"send"},[s("h2",[e._v("Conversation with "+e._s(e.user.username))]),s("textarea",{staticClass:"textarea",attrs:{id:"post-message",type:"text",name:"post-message",placeholder:"Enter new message...",cols:"40",rows:"5",required:""}}),s("p",[e._v("Send a message to "+e._s(e.user.username)+e._s(e.user.id))]),s("button",{on:{click:e.sendMessage}},[e._v("SEND")])]),null!=e.conversationsID?s("div",{staticClass:"list"},[s("MessageList",{attrs:{messages:e.messages}})],1):e._e()])},At=[],Nt=(s("4de4"),s("caad"),s("d81d"),s("25f0"),s("2532"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"list"},[s("h2",[e._v("Conversation:")]),e._l(e.messages,(function(e){return s("MessageListItem",{key:e.id,attrs:{message:e}})}))],2)}),Lt=[],Bt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"large-container",class:{own:e.isOwnMessage}},[s("div",[s("div",{staticClass:"container"},[e.isOwnMessage?s("h3",{staticClass:"delete",on:{click:e.deletePost}},[e._v("X")]):e._e(),s("h2",{staticClass:"message"},[e._v(e._s(e.message.text))]),s("p",[e._v("writen by: "+e._s(this.author.username))]),e.isOwnMessage&&1===e.message.unread?s("p",{staticClass:"read-status"},[e._v("(unread)")]):e._e()]),e._m(0)])])},Jt=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"bottom"},[s("div",{staticClass:"arrow"})])}],Ft={props:["message"],data:function(){return{author:Object}},computed:{isOwnMessage:function(){return this.$store.getters.currentUser.id===this.message.senderId}},methods:{fetchAuthor:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest/v1/users/".concat(e.message.senderId));case 2:return s=t.sent,t.next=5,s.json();case 5:e.author=t.sent;case 6:case"end":return t.stop()}}),t)})))()},markAsRead:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(1!==e.message.unread||e.isOwnMessage){t.next=9;break}return t.next=3,fetch("/rest/v1/messages/".concat(e.message.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({unread:0})});case 3:return s=t.sent,t.t0=console,t.next=7,s.json();case 7:t.t1=t.sent,t.t0.log.call(t.t0,t.t1);case 9:case"end":return t.stop()}}),t)})))()},deletePost:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest/v1/messages/".concat(e.message.id),{method:"DELETE"});case 2:e.$parent.fetchMessages();case 3:case"end":return t.stop()}}),t)})))()}},created:function(){this.fetchAuthor(),this.markAsRead()}},Qt=Ft,Ht=(s("bafb"),Object(f["a"])(Qt,Bt,Jt,!1,null,"154152bf",null)),Wt=Ht.exports,zt={components:{MessageListItem:Wt},props:["messages"],methods:{fetchMessages:function(){this.$parent.fetchMessages()}}},Xt=zt,Yt=(s("2b18"),Object(f["a"])(Xt,Nt,Lt,!1,null,"06311dd0",null)),Gt=Yt.exports,Vt={props:["user"],components:{MessageList:Gt},data:function(){return{conversationsID:null,messages:[],interval:null}},methods:{sendMessage:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""!==document.getElementById("post-message").value){t.next=2;break}return t.abrupt("return");case 2:if(null===e.conversationsID){t.next=7;break}e.postMessage(),e.fetchMessages(),t.next=20;break;case 7:return console.log("CONVERSATION WITH NEW USER"),t.next=10,e.createConversation();case 10:return s=t.sent,console.log("CONVERSATion started with id: ",s),t.next=14,e.addUserToConversation(e.user.id);case 14:return t.next=16,e.addUserToConversation(e.$store.getters.currentUser.id);case 16:return t.next=18,e.postMessage();case 18:return t.next=20,e.fetchMessages();case 20:case"end":return t.stop()}}),t)})))()},fetchConversations:function(e){return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest/v1/conversations/".concat(e));case 2:return s=t.sent,t.next=5,s.json();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))()},createConversation:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest/v1/conversations",{method:"POST"});case 2:return s=t.sent,t.next=5,s.json();case 5:return s=t.sent,e.conversationsID=s.lastInsertRowid,t.abrupt("return",s.lastInsertRowid);case 8:case"end":return t.stop()}}),t)})))()},addUserToConversation:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function s(){var r,n;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return r={userId:e,conversationId:t.conversationsID},console.log(r),s.next=4,fetch("/rest/v1/conversationsXusers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 4:return n=s.sent,s.next=7,n.json();case 7:n=s.sent,console.log(n);case 9:case"end":return s.stop()}}),s)})))()},postMessage:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s={senderId:e.$store.getters.currentUser.id,text:document.getElementById("post-message").value,send_date:Date.now(),conversationId:e.conversationsID},console.log("message",s),t.next=4,fetch("/rest/v1/messages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});case 4:return r=t.sent,t.next=7,r.json();case 7:r=t.sent,console.log(r),e.emptyInputField();case 10:case"end":return t.stop()}}),t)})))()},fetchMessages:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(null===e.conversationsID){t.next=7;break}return t.next=3,fetch("/rest/v1/messages/".concat(e.conversationsID));case 3:return s=t.sent,t.next=6,s.json();case 6:e.messages=t.sent;case 7:case"end":return t.stop()}}),t)})))()},checkIfAlreadyAConversation:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.fetchConversations(e.user.id);case 2:return s=t.sent,t.next=5,e.fetchConversations(e.$store.getters.currentUser.id);case 5:r=t.sent,s=s.map((function(e){return e["convID"]})),r=r.map((function(e){return e["convID"]})),n=s.filter((function(e){return r.includes(e)})),void 0!==n&&n.length>0&&(e.conversationsID=n[0]);case 10:case"end":return t.stop()}}),t)})))()},emptyInputField:function(){document.getElementById("post-message").value=""},setInterval:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){var e=this;this.interval=setInterval((function(){e.fetchMessages()}),5e3)}))},created:function(){this.checkIfAlreadyAConversation(),this.fetchMessages(),this.setInterval()},destroyed:function(){clearInterval(this.interval)},watch:{conversationsID:function(){this.fetchMessages()}}},Kt=Vt,Zt=(s("f5e0"),Object(f["a"])(Kt,qt,At,!1,null,"299aae8e",null)),es=Zt.exports,ts=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"title-container"},[s("h1",{staticClass:"title"},[e._v(e._s(e.user.username)+"'s conversations")])]),s("div",{staticClass:"find-container"},[s("span",{staticClass:"material-icons"},[e._v("search")]),s("h2",{staticClass:"find-btn",on:{click:e.showUserSearch}},[e._v("find user")])]),e.findUser?s("div",[s("SearchUser")],1):e._e(),s("ConversationsList",{attrs:{convIDs:e.convIDs}})],1)},ss=[],rs=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"list"},e._l(e.convIDs,(function(e){return s("ConversationsListItem",{key:e.id,attrs:{convID:e}})})),1)},ns=[],as=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("div",{staticClass:"head"},[s("div",{staticClass:"head-empty",on:{click:e.goToMessagePage}}),s("div",{staticClass:"head-delete"},[s("h2",{staticClass:"delete",on:{click:function(t){return t.preventDefault(),e.deleteConversation(t)}}},[e._v("x")])])]),s("div",{staticClass:"main",on:{click:e.goToMessagePage}},[s("div",{staticClass:"top"},e._l(this.otherUser,(function(t){return s("h2",{key:t.userId,staticClass:"conversation-item"},[e._v(e._s(t.username))])})),0),s("div",{staticClass:"center"},[s("div",{staticClass:"unread"},[0!=e.unreadMessages?s("h1",[e._v(e._s(e.unreadMessages))]):e._e()]),e._m(0)])])])},os=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"icon-img"},[s("span",{staticClass:"material-icons",staticStyle:{"font-size":"8em"}},[e._v("chat")])])}],is={props:["convID"],data:function(){return{otherUser:Object,unreadMessages:0}},computed:{currentUser:function(){return this.$store.getters.currentUser||""}},methods:{fetchUsersInConversations:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest/v1/conversationsXusers/".concat(e.convID.convID));case 2:return s=t.sent,t.next=5,s.json();case 5:s=t.sent,e.otherUser=s.filter((function(t){return t.userId!==e.currentUser.id}));case 7:case"end":return t.stop()}}),t)})))()},fetchFullAuthor:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest/v1/users/".concat(e.otherUser[0].userId));case 2:return s=t.sent,t.next=5,s.json();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))()},goToMessagePage:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.fetchFullAuthor();case 2:s=t.sent,e.$router.push({name:"MessagePage",params:{user:s}});case 4:case"end":return t.stop()}}),t)})))()},fetchNumberOfNewMessages:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest/v1/messages/count/".concat(e.convID.convID));case 2:return s=t.sent,t.next=5,s.json();case 5:s=t.sent,e.unreadMessages=s[0]["COUNT(unread)"];case 7:case"end":return t.stop()}}),t)})))()},deleteConversation:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s={userId:e.currentUser.id,conversationId:e.convID.convID},t.next=3,fetch("/rest/v1/conversationsXusers",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});case 3:return r=t.sent,t.next=6,r.json();case 6:r=t.sent,console.log(r),e.$parent.fetchConversations();case 9:case"end":return t.stop()}}),t)})))()}},created:function(){this.fetchUsersInConversations(),this.fetchNumberOfNewMessages()},watch:{otherUser:function(){null!==this.otherUser[0]&&void 0!==this.otherUser[0]||this.deleteConversation()}}},cs=is,us=(s("211ba"),Object(f["a"])(cs,as,os,!1,null,"23825998",null)),ls=us.exports,ds={props:["convIDs"],components:{ConversationsListItem:ls},methods:{fetchConversations:function(){this.$parent.fetchConversations()}}},hs=ds,fs=(s("a381"),Object(f["a"])(hs,rs,ns,!1,null,"96242d04",null)),ms=fs.exports,ps=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("div",{staticClass:"search"},[s("input",{staticClass:"input-field",attrs:{placeholder:"Enter username",id:"search",type:"text"},on:{keyup:e.getSearchedUser}})]),s("div",{staticClass:"content"},[null!=e.searchedUsers?s("div",e._l(e.searchedUsers,(function(t){return s("div",{key:t.id,staticClass:"list-item",on:{click:function(s){return e.goToMessagePage(t)}}},[s("h3",[e._v(e._s(t.username))])])})),0):e._e()])])},vs=[],gs={components:{},data:function(){return{searchedUsers:null}},methods:{getSearchedUser:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(s=document.getElementById("search").value,""!==s){t.next=4;break}return e.searchedUsers=null,t.abrupt("return");case 4:return t.next=6,fetch("/rest/v1/users/search/".concat(s));case 6:return r=t.sent,t.next=9,r.json();case 9:e.searchedUsers=t.sent;case 10:case"end":return t.stop()}}),t)})))()},goToMessagePage:function(e){this.$router.push({name:"MessagePage",params:{user:e}})}}},bs=gs,ws=(s("d3ba"),Object(f["a"])(bs,ps,vs,!1,null,"07514632",null)),_s=ws.exports,Cs={props:["user"],components:{ConversationsList:ms,SearchUser:_s},data:function(){return{convIDs:[],findUser:!1}},methods:{fetchConversations:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest/v1/conversations/".concat(e.user.id));case 2:return s=t.sent,t.next=5,s.json();case 5:s=t.sent,console.log(s),e.convIDs=s;case 8:case"end":return t.stop()}}),t)})))()},showUserSearch:function(){this.findUser=!this.findUser}},created:function(){this.fetchConversations()}},xs=Cs,Os=(s("b816"),Object(f["a"])(xs,ts,ss,!1,null,"e6ad267e",null)),ys=Os.exports;r["a"].use(D["a"]);var Is=[{path:"/",name:"HomePage",component:ee},{path:"/forum/:subforum",name:"SubforumPage",component:be,props:!0},{path:"/thread/:thread",name:"ThreadPage",component:ot,props:!0},{path:"/threadCreation/:subforum",name:"threadCreation",component:ht,props:!0},{path:"/profile/:user",name:"ProfilePage",component:Dt,props:!0},{path:"/messagepage/:user",name:"MessagePage",component:es,props:!0},{path:"/conversationspage/:user",name:"ConversationsPage",component:ys,props:!0}],ks=new D["a"]({routes:Is,mode:"history",base:"/",scrollBehavior:function(){return{x:0,y:0}}}),js=ks,Rs=s("2f62");r["a"].use(Rs["a"]);var Ps=new Rs["a"].Store({state:{currentUser:null},getters:{currentUser:function(e){return e.currentUser}},mutations:{setCurrentUser:function(e,t){e.currentUser=t}},actions:{fetchCurrentUser:function(e){return Object(c["a"])(regeneratorRuntime.mark((function t(){var s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s=e.commit,t.next=3,fetch("/rest/v1/whoami");case 3:return r=t.sent,t.next=6,r.json();case 6:r=t.sent,s("setCurrentUser",r);case 8:case"end":return t.stop()}}),t)})))()},postNewPost:function(e){return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest/v1/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});case 2:return s=t.sent,t.next=5,s.json();case 5:return s=t.sent,t.abrupt("return",s);case 7:case"end":return t.stop()}}),t)})))()},signInUser:function(e,t){return Object(c["a"])(regeneratorRuntime.mark((function s(){var r,n;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return r=e.commit,s.next=3,fetch("/rest/v1/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 3:return n=s.sent,s.next=6,n.json();case 6:return n=s.sent,r("setCurrentUser",n),s.abrupt("return",n);case 9:case"end":return s.stop()}}),s)})))()},registerUser:function(e,t){return Object(c["a"])(regeneratorRuntime.mark((function s(){var r,n;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return r=e.dispatch,s.next=3,fetch("/rest/v1/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 3:return n=s.sent,s.next=6,n.json();case 6:return n=s.sent,t.id=n.lastInsertRowid,r("signInUser",t),s.abrupt("return",n);case 10:case"end":return s.stop()}}),s)})))()}},modules:{}});r["a"].config.productionTip=!1,new r["a"]({store:Ps,router:js,render:function(e){return e(S)}}).$mount("#app")},5821:function(e,t,s){},"683d":function(e,t,s){},"69d3":function(e,t,s){"use strict";s("f9c8")},"6ca3":function(e,t,s){},7467:function(e,t,s){"use strict";s("d492")},"75a5":function(e,t,s){"use strict";s("8d50")},"85ec":function(e,t,s){},"885e":function(e,t,s){},"89fb":function(e,t,s){},"8d50":function(e,t,s){},"90b2":function(e,t,s){"use strict";s("1eff")},9232:function(e,t,s){},9386:function(e,t,s){"use strict";s("252d")},"962f":function(e,t,s){"use strict";s("557a")},"9f17":function(e,t,s){"use strict";s("9232")},a381:function(e,t,s){"use strict";s("89fb")},a7a0:function(e,t,s){"use strict";s("885e")},ab60:function(e,t,s){"use strict";s("d714")},b136:function(e,t,s){},b7b0:function(e,t,s){},b816:function(e,t,s){"use strict";s("0352")},bafb:function(e,t,s){"use strict";s("df18")},c040:function(e,t,s){},c0d9:function(e,t,s){"use strict";s("b136")},cec4:function(e,t,s){},d0b5:function(e,t,s){"use strict";s("39fc")},d3ba:function(e,t,s){"use strict";s("308b")},d454:function(e,t,s){"use strict";s("f71a")},d492:function(e,t,s){},d714:function(e,t,s){},ddaf:function(e,t,s){},df18:function(e,t,s){},e0fe:function(e,t,s){"use strict";s("683d")},f5e0:function(e,t,s){"use strict";s("3b70")},f71a:function(e,t,s){},f7af:function(e,t,s){"use strict";s("5821")},f9ba:function(e,t,s){},f9c8:function(e,t,s){}});
//# sourceMappingURL=app.1666c13f.js.map